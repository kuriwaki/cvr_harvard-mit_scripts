## Ticket Splitting Analysis {-}

To compare a voter's vote on two offices, one can select vote data and merge by `county_name` and `cvr_id`.

```{r}
# US President
az_pres <- ds |> 
  filter(state == "ARIZONA", office == "US PRESIDENT") |> 
  select(state, county_name, cvr_id, 
         candidate_pres = candidate,
         party_pres = party_detailed)

# US House
az_ushou <- ds |> 
  filter(state == "ARIZONA", office == "US HOUSE") |> 
  select(state, county_name, cvr_id, 
         district_ushou = district,
         candidate_ushou = candidate,
         party_ushou = party_detailed)
```

It is generally a good idea to join datasets while they are pre-collected calls. This way, arrow can optimize the memory usage.

```{r}
az_joined <- left_join(
  az_pres,
  az_ushou,
  by = c("state", "county_name", "cvr_id"),
  relationship = "one-to-one"
) |> 
  collect()

az_joined
```

A simple ticket splitting comparison can be done with:

```{r}
xtabs(~ candidate_pres + party_ushou, az_joined)
```


To see as a fraction of the Presidential vote, use row proportions

```{r}
xtabs(~ candidate_pres + party_ushou, az_joined) |> 
  prop.table(margin = 1) |> 
  round(2)
```

We see that 5% of Trump voters split their ticket, and 5% of Biden voters split their ticket.

```{r}
xtabs(~ candidate_pres + party_ushou, az_joined) |> 
  prop.table(margin = 2) |> 
  round(3)
```

Democrats were only slightly likely to vote for Biden.


## References

::: {#refs}
:::

